<h1>Specific Driver</h1>

<%# Calculate total earnings/ratings %>

<% total_earnings, total_ratings = 0, 0 %>
<% @driver.trips.each do |trip|  %>
  <% if !trip.is_archive %>
    <% total_earnings += [(trip.cost - 1.65) * 0.8, 0].max %>
    <% total_ratings += trip.rating %>
  <% end %>
<% end %>

<h1>Driver Info:</h1>
<div>
  Name: <%= @driver.name %> <br>
  VIN: <%= @driver.vin %> <br>
  Status: <%= !@driver.is_active ? "DEACTIVATED" : @driver.available ? "AVAILABLE" : "UNAVAILABLE" %> <br>
  Total Earnings: $<%= total_earnings %> <br>
  Average Rating: <%= (total_ratings.to_f / @driver.trips.length).round(2)  %>
</div>

<br>

<div>
  <ul>
    <% @driver.trips.each do |trip|  %>
      <% if !trip.is_archive %>
        <li>
          Trip ID: <%= trip.id %> <br> 
          Date: <%= trip.date %> <br>
          Rating: <%= trip.rating %> <br>
          Cost: $<%= trip.cost %> <br>
          Passenger: <%= "#{trip.passenger.name} (ID: #{trip.passenger_id})" %> <br>
        </li>
      <% end %>
    <% end %>
  </ul>
</div>

<%= link_to "Edit Driver Info", edit_driver_path %>